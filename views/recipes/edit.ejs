<script defer src="/js/recipes/addIngredient.js"></script>
<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/recipes/new.css">
<%- include('../partials/nav') %>

<main>
  <div id="topSpaceBuffer"></div>
  <div id="newRecipe">
  <h1><%= title %></h1>
    <% if (user?.profile._id) { %>
      <div id="createRecipe">
        <form action="/recipes/<%= recipe._id%>?_method=PUT" method="POST">
          <label>Recipe Title:
            <input type="text" name="name" value="<%=recipe.name%>">
          </label>
          <label>Preperation Time: 
            <input type="number" name="prepTime" value="<%=recipe.prepTime%>">
          </label>
          <label>Cooking Time:
            <input type="number" name="cookTime" value="<%=recipe.cookTime%>">
          </label>
          <label>Cooking Temperature: 
            <input type="number" name="temp"  value="<%=recipe.temp%>">
          </label>
          <label>Number of portions: 
            <input type="number" name="yield" min=1 value="<%=recipe.yield%>" required>
          </label>
          <br/>
          <div id="ingredienList">
          <% recipe.ingredients.forEach(ingredient => { %>
            <input type="text" name="ingredients" value="<%=ingredient %>"><br/>
          <%});%>
            
            <a href="#" id="addIngredientLink" onclick="addFields()">Add more Ingredients</a>
            <div id="container"></div>
          </div>
          <label>Preperation Instructions: 
            <textarea name="instructions" cols="55" rows="20"><%=recipe.instructions%></textarea>
          </label>
          <label>Picture URL:
            <input type="text" name="picture" id="pictureUrl">
          </label>
          <% if (recipe.owner.equals(user?.profile._id)) { %>
            <button type="submit">Update Recipe</button>
          </form>
            <form action="/recipes/<%= recipe._id %>?_method=DELETE" method="POST">
              <input hidden name="ownerName" value="<%=ownerName%>">
              <input hidden name="ownerAvatar" value="<%=ownerAvatar%>">
              <button class="btn" type="submit">Delete</button>
            </form>
            <% } %>
            <form>
              <input type="button" value="Go back!" onclick="history.back()">
            </form>
      </div>
    <% } else{ %>
      <h1>You must be Logged in to add recipes!</h1>
    <% } %>
  </div>
</main>

<%- include('../partials/footer') %>
